{% extends 'shared/_MainLayout.html' %}
{% load humanize %}
{% load static %}
{% block content %}

    <style>
        .datetime-small {
            font-size: 1.2em; /* کوچک‌تر کردن فونت تاریخ و ساعت */
            margin-right: 10px; /* فاصله بین عنوان و تاریخ/ساعت */
            vertical-align: middle; /* تنظیم تراز عمودی */
        }

        .text-facebook {
            display: inline; /* نمایش عنوان در یک خط */
        }

    </style>
    <style>
        .calendar-table .fc-day-top {
            position: relative; /* برای قرار دادن فرزندان */
            padding: 5px; /* کمی فاصله برای زیبایی */
        }

        .calendar-table .fc-day-number {
            font-weight: bold;
            display: block;
            margin: 0;
            padding: 0; /* لغو حاشیه */
            text-align: left; /* تراز چپ */
        }

        .calendar-table .fc-recive-number,
        .calendar-table .fc-pay-number,
        .calendar-table .fc-loan-number {
            font-size: 1.2rem; /* اندازه متن */
            display: block; /* تقسیم نمایش به سطرهای جدید */
        }

        .calendar-table .fc-recive-number {
            color: #007bff; /* رنگ سبد خرید */
            text-align: right; /* تراز راست برای شماره دریافتی */
        }

        .calendar-table .fc-pay-number {
            color: #df0808; /* رنگ  */
            text-align: right; /* تراز راست برای شماره پرداختی */
        }

        .calendar-table .fc-loan-number {
            color: #3b5998; /* رنگ  */
            text-align: right; /* تراز راست برای شماره پرداختی */
        }

        .calendar-table th {
            border: 1px solid #fdd49a;
            background-color: transparent !important; /* حذف رنگ پس‌زمینه */
        }
    </style>
    <style>
        .small-logo {
            width: 20px; /* تنظیم اندازه کوچک لوگو */
            height: auto;
        }
    </style>


    <div class="content-wrapper">

        <!--ردیف تایتل-->
        <div class="page-title">
            <div class="row">
                <div class="col-sm-9">
                    <h3 class="mb-0 text-facebook d-inline">داشبورد مدیریتی فروشگاه یاس مجلل</h3>
                    <span id="datetime" class="datetime-small">در حال بارگذاری...</span>
                </div>
                <div class="col-sm-3">
                    <ol class="breadcrumb pt-0 pr-0 float-left float-sm-right">
                        <li class="breadcrumb-item"><a href="/" class="default-color"> خانه</a></li>
                        <li class="breadcrumb-item active">داشبورد 1</li>
                    </ol>
                </div>
            </div>
        </div>

        <div class="row">
            <!--سود ناویژه-->
            <div class="col-xl-4 mb-30">
                <div class="card card-statistics h-100">
                    <div class="card-body text-left">
                        <h5 class="card-title">سود ناویژه</h5>
                        <div class="row">
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    <h4 class="timer text-primary" data-to="{{ today_data.sood_navizhe }}"
                                        data-speed="5000">{{ today_data.sood_navizhe }}</h4>
                                    <label class="text-capitalize mt-0">امروز </label>
                                </div>
                            </div>
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    <h4 class="timer text-success" data-to="{{ yesterday_data.sood_navizhe }}"
                                        data-speed="5000">{{ yesterday_data.sood_navizhe }}</h4>
                                    <label class="text-capitalize mt-0">دیروز </label>
                                </div>
                            </div>
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    <h4 class="timer text-danger" data-to="{{ minfo.sood_navizhe_total }}"
                                        data-speed="5000">{{ minfo.sood_navizhe_total }}</h4>
                                    <label class="text-capitalize mt-0">ازابتدای سال مالی</label>
                                </div>
                            </div>
                        </div>
                        {#                        <div class="divider"></div>#}
                        {#                        <h6 class="text-capitalize mt-0 text-center text-primary">خالص در آمد فروش</h6>#}
                        {#                        <div class="row">#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <div class="counter counter-small">#}
                        {#                                    <h4 class="timer text-primary" data-to="{{ today_data.khales_forosh }}"#}
                        {#                                        data-speed="5000">{{ today_data.khales_forosh }}</h4>#}
                        {#                                    <label class="text-capitalize mt-0">امروز ({{ last_update_time|timesince }})#}
                        {#                                        قبل</label>#}
                        {#                                </div>#}
                        {#                            </div>#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <div class="counter counter-small">#}
                        {#                                    <h4 class="timer text-success" data-to="{{ yesterday_data.khales_forosh }}"#}
                        {#                                        data-speed="5000">{{ yesterday_data.khales_forosh }}</h4>#}
                        {#                                    <label class="text-capitalize mt-0">دیروز </label>#}
                        {#                                </div>#}
                        {#                            </div>#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <a href="/balance-sheet-moin/400" target="_blank">#}
                        {#                                    <div class="counter counter-small">#}
                        {#                                        <h4 class="timer text-danger" data-to="{{ allday_data.khales_forosh }}"#}
                        {#                                            data-speed="5000">{{ allday_data.khales_forosh }}</h4>#}
                        {#                                        <label class="text-capitalize mt-0">ازابتدای سال مالی</label>#}
                        {#                                    </div>#}
                        {#                                </a>#}
                        {#                            </div>#}
                        {#                        </div>#}
                        {#                        <div class="divider"></div>#}
                        {#                        <h6 class="text-capitalize mt-0 text-center text-danger">بهای تمام شده کالای فروش رفته</h6>#}
                        {#                        <div class="row">#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <div class="counter counter-small">#}
                        {#                                    <h4 class="timer text-primary" data-to="{{ today_data.baha_tamam_forosh }}"#}
                        {#                                        data-speed="5000">{{ today_data.baha_tamam_forosh }}</h4>#}
                        {#                                    <label class="text-capitalize mt-0">امروز </label>#}
                        {#                                </div>#}
                        {#                            </div>#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <div class="counter counter-small">#}
                        {#                                    <h4 class="timer text-success" data-to="{{ yesterday_data.baha_tamam_forosh }}"#}
                        {#                                        data-speed="5000">{{ yesterday_data.baha_tamam_forosh }}</h4>#}
                        {#                                    <label class="text-capitalize mt-0">دیروز </label>#}
                        {#                                </div>#}
                        {#                            </div>#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <a href="/balance-sheet-moin/500" target="_blank">#}
                        {##}
                        {#                                    <div class="counter counter-small">#}
                        {#                                        <h4 class="timer text-danger" data-to="{{ allday_data.baha_tamam_forosh }}"#}
                        {#                                            data-speed="5000">{{ allday_data.baha_tamam_forosh }}</h4>#}
                        {#                                        <label class="text-capitalize mt-0">ازابتدای سال مالی</label>#}
                        {#                                    </div>#}
                        {#                                </a>#}
                        {#                            </div>#}
                        {#                        </div>#}
                        {#                        <div class="divider"></div>#}
                        <div class="divider"></div>
                        <div class="row">
                            <div class="col-6 col-sm-4 mt-15 text-center">
                                <b>متوسط روز های فعال</b>
                                <h4>{{ minfo.sood_navizhe_ave|floatformat:0 }}</h4>
                            </div>
                            <div class="col-6 col-sm-4 mt-15 text-center">
                                <b>کمترین روزانه</b>
                                <h4>{{ minfo.sood_navizhe_min|floatformat:0 }}</h4>
                            </div>
                            <div class="col-12 col-sm-4 mt-15 text-center">
                                <b>بیشترین روزانه</b>
                                <h4>{{ minfo.sood_navizhe_max|floatformat:0 }}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--سود ویژه-->
            <div class="col-xl-4 mb-30">
                <div class="card card-statistics h-100">
                    <div class="card-body text-left">
                        <h5 class="card-title">سود خالص</h5>
                        <div class="row">
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    <h4 class="timer text-primary" data-to="{{ today_data.sood_vizhe }}"
                                        data-speed="5000">{{ today_data.sood_vizhe }}</h4>
                                    <label class="text-capitalize mt-0">امروز </label>
                                </div>
                            </div>
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    <h4 class="timer text-success" data-to="{{ yesterday_data.sood_vizhe }}"
                                        data-speed="5000">{{ yesterday_data.sood_vizhe }}</h4>
                                    <label class="text-capitalize mt-0">دیروز </label>
                                </div>
                            </div>
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    <h4 class="timer text-danger" data-to="{{ minfo.sood_vizhe_total }}"
                                        data-speed="5000">{{ minfo.sood_vizhe_total }}</h4>
                                    <label class="text-capitalize mt-0">ازابتدای سال مالی</label>
                                </div>
                            </div>
                        </div>
                        {#                        <h6 class="text-capitalize mt-0 text-center text-primary">سایر درآمدها</h6>#}
                        {#                        <div class="row">#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {##}
                        {#                                <div class="counter counter-small">#}
                        {#                                    <h4 class="timer text-primary" data-to="{{ today_data.sayer_daramad }}"#}
                        {#                                        data-speed="5000">{{ today_data.sayer_daramad }}</h4>#}
                        {#                                    <label class="text-capitalize mt-0">امروز ({{ last_update_time|timesince }})#}
                        {#                                        قبل</label>#}
                        {#                                </div>#}
                        {#                            </div>#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <div class="counter counter-small">#}
                        {#                                    <h4 class="timer text-success" data-to="{{ yesterday_data.sayer_daramad }}"#}
                        {#                                        data-speed="5000">{{ yesterday_data.sayer_daramad }}</h4>#}
                        {#                                    <label class="text-capitalize mt-0">دیروز </label>#}
                        {#                                </div>#}
                        {#                            </div>#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <a href="/balance-sheet-moin/401" target="_blank">#}
                        {##}
                        {#                                    <div class="counter counter-small">#}
                        {#                                        <h4 class="timer text-danger" data-to="{{ allday_data.sayer_daramad }}"#}
                        {#                                            data-speed="5000">{{ allday_data.sayer_daramad }}</h4>#}
                        {#                                        <label class="text-capitalize mt-0">ازابتدای سال مالی</label>#}
                        {#                                    </div>#}
                        {#                                </a>#}
                        {#                            </div>#}
                        {#                        </div>#}
                        {#                        <div class="divider"></div>#}
                        {#                        <h6 class="text-capitalize mt-0 text-center text-danger">سایر هزینه ها</h6>#}
                        {#                        <div class="row">#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <div class="counter counter-small">#}
                        {#                                    <h4 class="timer text-primary" data-to="{{ today_data.sayer_hazine }}"#}
                        {#                                        data-speed="5000">{{ today_data.sayer_hazine }}</h4>#}
                        {#                                    <label class="text-capitalize mt-0">امروز </label>#}
                        {#                                </div>#}
                        {#                            </div>#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <div class="counter counter-small">#}
                        {#                                    <h4 class="timer text-success" data-to="{{ yesterday_data.sayer_hazine }}"#}
                        {#                                        data-speed="5000">{{ yesterday_data.sayer_hazine }}</h4>#}
                        {#                                    <label class="text-capitalize mt-0">دیروز </label>#}
                        {#                                </div>#}
                        {#                            </div>#}
                        {#                            <div class="col-4 col-sm-4 mb-15 text-center">#}
                        {#                                <a href="/balance-sheet-moin/501" target="_blank">#}
                        {#                                    <div class="counter counter-small">#}
                        {#                                        <h4 class="timer text-danger" data-to="{{ allday_data.sayer_hazine }}"#}
                        {#                                            data-speed="5000">{{ allday_data.sayer_hazine }}</h4>#}
                        {#                                        <label class="text-capitalize mt-0">ازابتدای سال مالی</label>#}
                        {#                                    </div>#}
                        {#                                </a>#}
                        {#                            </div>#}
                        {#                        </div>#}
                        {#                        <div class="divider"></div>#}


                        <div class="divider"></div>
                        <div class="row">
                            <div class="col-6 col-sm-4 mt-15 text-center">
                                <b>متوسط روز های فعال</b>
                                <h4>{{ minfo.sood_vizhe_ave|floatformat:0 }}</h4>
                            </div>
                            <div class="col-6 col-sm-4 mt-15 text-center">
                                <b>کمترین روزانه</b>
                                <h4>{{ minfo.sood_vizhe_min|floatformat:0 }}</h4>
                            </div>
                            <div class="col-12 col-sm-4 mt-15 text-center">
                                <b>بیشترین روزانه</b>
                                <h4>{{ minfo.sood_vizhe_max|floatformat:0 }}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!--ردیف گزارش فروش و سود ناخالص-->
        <div class="row">
            <!--نمودار سود ناویژه-->
            <div class="col-xl-4 mb-30">
                <div class="card card-statistics h-100">
                    <div class="card-body">
                        <h5 class="card-title"> گزارش سود ناویژه</h5>
                        <div class="tab round">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active show" id="home-07-tab" data-toggle="tab" href="#home-07"
                                       role="tab" aria-controls="home-07" aria-selected="true"> <i
                                            class="fa fa-calendar-check-o"></i> روزانه</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="profile-07-tab" data-toggle="tab" href="#profile-07"
                                       role="tab" aria-controls="profile-07" aria-selected="false"><i
                                            class="fa fa-calendar"></i> ماهانه </a>
                                </li>
                                {#                                <li class="nav-item">#}
                                {#                                    <a class="nav-link" id="portfolio-07-tab" data-toggle="tab" href="#portfolio-07"#}
                                {#                                       role="tab" aria-controls="portfolio-07" aria-selected="false"><i#}
                                {#                                            class="fa  fa-calendar-o"></i>  سالانه </a>#}
                                {#                                </li>#}
                                {#                <li class="nav-item">#}
                                {#                  <a class="nav-link active show" id="contact-07-tab" data-toggle="tab" href="#contact-07" role="tab" aria-controls="contact-07" aria-selected="true"><i class="fa fa-check-square-o"></i> تماس </a>#}
                                {#                </li>#}
                            </ul>
                            <div class="tab-content">
                                <div class="tab-pane fade active show" id="home-07" role="tabpanel"
                                     aria-labelledby="home-07-tab">
                                    <canvas id="Chart1" height="250"></canvas>
                                </div>
                                <div class="tab-pane fade" id="profile-07" role="tabpanel"
                                     aria-labelledby="profile-07-tab">
                                    <canvas id="Chart2" height="250"></canvas>

                                </div>
                                <div class="tab-pane fade" id="portfolio-07" role="tabpanel"
                                     aria-labelledby="portfolio-07-tab">
                                    {#                                    <div id="bar-chart">{{ fig_html3|safe }}</div>#}
                                </div>
                                <div class="tab-pane fade " id="contact-07" role="tabpanel"
                                     aria-labelledby="contact-07-tab">
                                    {#                                    <p>...</p>#}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--نمودار سود ویژه-->
            <div class="col-xl-4 mb-30">
                <div class="card card-statistics h-100">
                    <div class="card-body">
                        <h5 class="card-title"> گزارش سود خالص</h5>
                        <div class="tab round ">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active show " id="home-08-tab" data-toggle="tab" href="#home-08"
                                       role="tab" aria-controls="home-08" aria-selected="true"> <i
                                            class="fa fa-calendar-check-o"></i> روزانه</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="profile-08-tab" data-toggle="tab" href="#profile-08"
                                       role="tab" aria-controls="profile-08" aria-selected="false"><i
                                            class="fa fa-calendar"></i> ماهانه </a>
                                </li>
                                {#                                <li class="nav-item">#}
                                {#                                    <a class="nav-link" id="portfolio-08-tab" data-toggle="tab" href="#portfolio-08"#}
                                {#                                       role="tab" aria-controls="portfolio-08" aria-selected="false"><i#}
                                {#                                            class="fa  fa-calendar-o"></i>  ماهانه </a>#}
                                {#                                </li>#}
                                {#                <li class="nav-item">#}
                                {#                  <a class="nav-link active show" id="contact-08-tab" data-toggle="tab" href="#contact-08" role="tab" aria-controls="contact-08" aria-selected="true"><i class="fa fa-check-square-o"></i> تماس </a>#}
                                {#                </li>#}
                            </ul>
                            <div class="tab-content">
                                <div class="tab-pane fade active show" id="home-08" role="tabpanel"
                                     aria-labelledby="home-08-tab">
                                    <canvas id="Chart4" height="250"></canvas>

                                </div>
                                <div class="tab-pane fade" id="profile-08" role="tabpanel"
                                     aria-labelledby="profile-08-tab">
                                    <canvas id="Chart5" height="250"></canvas>
                                </div>
                                <div class="tab-pane fade" id="portfolio-08" role="tabpanel"
                                     aria-labelledby="portfolio-08-tab">
                                    <p>..</p>
                                </div>
                                <div class="tab-pane fade " id="contact-08" role="tabpanel"
                                     aria-labelledby="contact-08-tab">
                                    <p>...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="row">

            <!--اسناد دریافتنی-->
            <div class="col-xl-4 mb-30">
                <div class="card card-statistics h-100">
                    <div class="card-body text-left">
                        <h5 class="card-title">اسناد در یافتنی</h5>
                        <h6 class="text-capitalize mt-0">میلیون تومان</h6>
                        <div class="row">
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    {% if today_data.asnad_daryaftani > yesterday_data.asnad_daryaftani %}
                                        <h4 class="timer text-danger" data-to="{{ today_data.asnad_daryaftani }}"
                                            data-speed="5000">
                                            {{ today_data.asnad_daryaftani }}
                                        </h4>
                                        <label class="text-capitalize mt-0"> <i class="fa fa-long-arrow-up text-danger"
                                                                                aria-hidden="true"></i>
                                            برآیند امروز ({{ last_update_time|timesince }})قبل
                                        </label>
                                    {% else %}
                                        <h4 class="timer text-success" data-to="{{ today_data.asnad_daryaftani }}"
                                            data-speed="5000">
                                            {{ today_data.asnad_daryaftani }}
                                        </h4>
                                        <label class="text-capitalize mt-0"> <i class="fa fa-arrow-down text-success"
                                                                                aria-hidden="true"></i>
                                            برآیند امروز ({{ last_update_time|timesince }})قبل
                                        </label>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    {% if today_data.asnad_daryaftani > yesterday_data.asnad_daryaftani %}
                                        <h4 class="timer text-success" data-to="{{ yesterday_data.asnad_daryaftani }}"
                                            data-speed="5000">{{ yesterday_data.asnad_daryaftani|floatformat:0 }}</h4>
                                    {% else %}
                                        <h4 class="timer text-danger" data-to="{{ yesterday_data.asnad_daryaftani }}"
                                            data-speed="5000">{{ yesterday_data.asnad_daryaftani }}</h4>
                                    {% endif %}
                                    <label class="text-capitalize mt-0">برآیند دیروز </label>
                                </div>
                            </div>
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    <h4 class="timer text-danger" data-to="{{ allday_data.asnad_daryaftani }}"
                                        data-speed="5000">{{ allday_data.asnad_daryaftani }}</h4>
                                    <label class="text-capitalize mt-0"> مانده </label>
                                </div>
                            </div>
                        </div>
                        <div class="divider"></div>
                        <div class="row">

                            <div class="col-6 col-sm-4 mt-15 text-center">
                                <a href="/acc/cheques_recieve_total">
                                    <b>کل چک های دارای مانده</b>
                                    <h4>{{ r_chequ_data.tmandeh|floatformat:0|intcomma:False }}</h4>
                                </a>
                            </div>

                            <div class="col-6 col-sm-4 mt-15 text-center">
                                <b>چک های تاریخ گذشته تا امروز</b>
                                <h4>{{ r_chequ_data.pastmandeh|floatformat:0|intcomma:False }}</h4>
                            </div>
                            <div class="col-12 col-sm-4 mt-15 text-center">
                                <b>چکهای فردا به بعد</b>
                                <h4>{{ r_chequ_data.postmandeh|floatformat:0|intcomma:False }}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--اسناد پرداختنی-->
            <div class="col-xl-4 mb-30">
                <div class="card card-statistics h-100">
                    <div class="card-body text-left">
                        <h5 class="card-title">اسناد پرداختنی</h5>
                        <h6 class="text-capitalize mt-0">میلیون تومان</h6>
                        <div class="row">
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    {% if today_data.asnad_pardakhtani < yesterday_data.asnad_pardakhtani %}
                                        <h4 class="timer text-danger" data-to="{{ today_data.asnad_pardakhtani }}"
                                            data-speed="5000">
                                            {{ today_data.asnad_pardakhtani }}
                                        </h4>
                                        <label class="text-capitalize mt-0"> <i class="fa fa-long-arrow-up text-danger"
                                                                                aria-hidden="true"></i>
                                            برآیند امروز ({{ last_update_time|timesince }})قبل
                                        </label>
                                    {% else %}
                                        <h4 class="timer text-success" data-to="{{ today_data.asnad_pardakhtani }}"
                                            data-speed="5000">
                                            {{ today_data.asnad_pardakhtani }}
                                        </h4>
                                        <label class="text-capitalize mt-0"> <i class="fa fa-arrow-down text-success"
                                                                                aria-hidden="true"></i>
                                            برآیند امروز ({{ last_update_time|timesince }})قبل
                                        </label>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    {% if today_data.asnad_pardakhtani < yesterday_data.asnad_pardakhtani %}
                                        <h4 class="timer text-success" data-to="{{ yesterday_data.asnad_pardakhtani }}"
                                            data-speed="5000">{{ yesterday_data.asnad_pardakhtani|floatformat:0 }}</h4>
                                    {% else %}
                                        <h4 class="timer text-danger" data-to="{{ yesterday_data.asnad_pardakhtani }}"
                                            data-speed="5000">{{ yesterday_data.asnad_pardakhtani }}</h4>
                                    {% endif %}
                                    <label class="text-capitalize mt-0">برآیند دیروز </label>
                                </div>
                            </div>
                            <div class="col-4 col-sm-4 mb-15 text-center">
                                <div class="counter counter-small">
                                    <h4 class="timer text-danger" data-to="{{ allday_data.asnad_pardakhtani }}"
                                        data-speed="5000">{{ allday_data.asnad_pardakhtani }}</h4>
                                    <label class="text-capitalize mt-0"> مانده </label>
                                </div>
                            </div>
                        </div>
                        <div class="divider"></div>
                        <div class="row">

                            <div class="col-6 col-sm-4 mt-15 text-center">
                                <a href="/acc/cheques_pay_total">
                                    <b>کل چک های دارای مانده</b>
                                    <h4>{{ p_chequ_data.tmandeh|floatformat:0|intcomma:False }}</h4>
                                </a>
                            </div>

                            <div class="col-6 col-sm-4 mt-15 text-center">
                                <b>چک های تاریخ گذشته تا امروز</b>
                                <h4>{{ p_chequ_data.pastmandeh|floatformat:0|intcomma:False }}</h4>
                            </div>
                            <div class="col-12 col-sm-4 mt-15 text-center">
                                <b>چکهای فردا به بعد</b>
                                <h4>{{ p_chequ_data.postmandeh|floatformat:0|intcomma:False }}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="row">

            <!-- تقویم چک ها -->
            <div id="calendarf" class="col-md-8 mb-30">
                <div class="card card-statistics h-100">
                    <div class="card-body">
                        <div class="text-center mb-4">
                            <h2>{{ month_name }} ماه {{ year }}</h2>
                        </div>
                        <div class="card-body">
                            <h5 class="mb-15 pb-0 border-0 card-title">بدهکاران و اقساط</h5>
                            <div class="table-responsive">
                                <table class="table center-aligned-table mb-10 text-center ">
                                    <thead>
                                    <tr class="text-dark">
                                        <th></th>
                                        <th></th>
                                        <th>کل بدهی</th>
                                        <th>بدون وام</th>
                                        <th>کسری وام</th>
                                        <th>اقساط ماه های قبل</th>
                                        <th>{{ month_name }} ماه {{ year }}</th>
                                        <th>اقساط ماه های بعد</th>
                                    </tr>
                                    </thead>
                                    <tbody>

                                    <tr>
                                        <td><i class="fa fa-download text-facebook fa-2x"></i></td>
                                        <td><h5 class="text-facebook">مشتریان</h5></td>
                                        <td>
                                            <a href="/acc/jariashkhas/moshtarian/detaile/4"
                                               target="_blank">
                                                <h5 class="text-linkedin">{{ month_loan_data.total_bedehkar|floatformat:0|intcomma:False }}</h5>
                                            </a>
                                        </td>

                                        <td>
                                            <a href="/acc/jariashkhas/moshtarian/detaile/6"
                                               target="_blank">
                                                <h5 class="text-danger">{{ month_loan_data.not_loan|floatformat:0|intcomma:False }}</h5>
                                            </a>
                                        </td>
                                        <td>
                                            <a href="/acc/jariashkhas/moshtarian/detaile/7"
                                               target="_blank">
                                                <h5 class="text-danger">{{ month_loan_data.loan_gap|floatformat:0|intcomma:False }}</h5>
                                            </a>
                                        </td>

                                        <td>
                                            <h5 class="text-danger">{{ month_loan_data.past_month_loan|floatformat:0|intcomma:False }}</h5>
                                        </td>

                                        <td>
                                            <h5 class="text-dark">{{ month_loan_data.this_month_loan|floatformat:0|intcomma:False }}</h5>
                                        </td>

                                        <td>
                                            <h5 class="text-success">{{ month_loan_data.post_month_loan|floatformat:0|intcomma:False }}</h5>
                                        </td>
                                    </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>


                        <div class="card-body">
                            <h5 class="mb-15 pb-0 border-0 card-title">چک ها</h5>
                            <div class="table-responsive">
                                <table class="table center-aligned-table mb-10 text-center ">
                                    <thead>
                                    <tr class="text-dark">
                                        <th></th>
                                        <th></th>
                                        <th>ماه های قبلی</th>
                                        <th>{{ month_name }} ماه {{ year }}</th>
                                        <th>ماه های بعد</th>
                                    </tr>
                                    </thead>
                                    <tbody>

                                    <tr>
                                        <td><i class="fa fa-download text-primary fa-2x"></i></td>
                                        <td><h5 class="text-primary">چکهای دریافتی</h5></td>
                                        <td>
                                            <h5 class="text-danger">{{ month_cheque_data.past_recive|floatformat:0|intcomma:False }}</h5>
                                        </td>
                                        <td>
                                            <h5 class="text-twitter">{{ month_cheque_data.this_month_recive|floatformat:0|intcomma:False }}</h5>
                                        </td>
                                        <td>
                                            <h5 class="text-success">{{ month_cheque_data.post_recive|floatformat:0|intcomma:False }}</h5>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><i class="fa fa-upload text-danger fa-2x"></i></td>
                                        <td><h5 class="text-danger">چکهای پرداختی</h5></td>
                                        <td>
                                            <h5 class="text-primary">{{ month_cheque_data.past_pay|floatformat:0|intcomma:False }}</h5>
                                        </td>
                                        <td>
                                            <h5 class="text-danger">{{ month_cheque_data.this_month_pay|floatformat:0|intcomma:False }}</h5>
                                        </td>
                                        <td>
                                            <h5 class="text-warning">{{ month_cheque_data.post_pay|floatformat:0|intcomma:False }}</h5>
                                        </td>
                                    </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="calendar-header">
                            <button id="prev-month" class="btn btn-secondary">&lt;</button>
                            <span>{{ month_name }} {{ year }}</span>
                            <button id="next-month" class="btn btn-secondary">&gt;</button>
                        </div>
                        <table class="table table-bordered calendar-table">
                            <thead class="thead-light">
                            <tr class="text-center">
                                <th>شنبه</th>
                                <th>یکشنبه</th>
                                <th>دوشنبه</th>
                                <th>سه‌شنبه</th>
                                <th>چهارشنبه</th>
                                <th>پنج‌شنبه</th>
                                <th>جمعه</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for week in days_in_month %}
                                <tr>
                                    {% for day in week %} {% if day %}
                                        <td>
                                            <div class="fc-day-top">
                                                <span class="fc-day-number"><h5>{{ day.jday }}</h5></span>
                                                <span class="fc-loan-number">{{ day.loans|floatformat:0|intcomma:False }}</span>
                                                <div class="progress mb-3" data-toggle="popover" data-html="true"
                                                     data-original-title="لیست  اقساط برای تاریخ {{ day.today_loans.last.tarikh }}"
                                                     data-content="
                                                     <table class='table center-aligned-table mb-0'>
                                                     <thead>
                                                     <tr>
                                                     <th>کد قسط</th>
                                                     <th>فرد</th>
                                                     <th>مبلغ</th>
                                                     </tr>
                                                     </thead>
                                                     <tbody>
                                                             {% for l in day.today_loans %}
<tr>
<td>{{ l.loan_code }}</td>
<td><a href='/acc/jariashkhas/moshtari/{{ l.loan.person.per_taf }}' target='_blank'>
                                                         {{ l.loan.person.name }}{{ l.loan.person.lname }}</a></td>
<td>{{ l.cost|floatformat:0|intcomma:False }}</td>
</tr>
{% endfor %}
</tbody>
</table>">
                                                    <div class="progress-bar progress-bar-striped bg-facebook"
                                                         role="progressbar"
                                                         style="width: {% widthratio day.loans max_cheque 100 %}%"
                                                         aria-valuenow="{{ day.loans }}" aria-valuemin="0"
                                                         aria-valuemax="{{ max_cheque }}"></div>
                                                </div>
                                                <span class="fc-recive-number">{{ day.recive|floatformat:0|intcomma:False }}</span>
                                                <div class="progress mb-3" data-toggle="popover" data-html="true"
                                                     data-original-title="لیست  چکهای دریافتی برای تاریخ {{ day.today_recive_cheque.last.cheque_tarik }}"

                                                     data-content="
                                                     <table class='table'>
                                                     <thead>
                                                     <tr>
                                                     <th></th>
                                                     <th>بانک</th>
                                                     <th>شخص</th>
                                                     <th>مبلغ</th>
                                                     <tr>
                                                     </thead>
                                                     <tbody>
{% for cheque in day.today_recive_cheque %}
{% with 'images/bank/'|add:cheque.bank_logo as logo_path %}

<tr>
<td><img src='{% static logo_path %}' class='small-logo'></td>
<td>{{ cheque.bank_name }}-{{ cheque.bank_branch }}</td>
<td>{{ cheque.person }}</td>
<td>{{ cheque.cost|floatformat:0|intcomma:False }}</td>

</tr>
{% endwith %}
{% endfor %}
</tbody>
</table>">

                                                    <div class="progress-bar progress-bar-striped bg-primary"
                                                         role="progressbar"
                                                         style="width: {% widthratio day.recive max_cheque 100 %}%"
                                                         aria-valuenow="{{ day.recive }}" aria-valuemin="0"
                                                         aria-valuemax="{{ max_cheque }}"></div>
                                                </div>
                                                <span class="fc-pay-number">{{ day.pay|floatformat:0|intcomma:False }}</span>
                                                <div class="progress mb-3" data-toggle="popover" data-html="true"
                                                     data-original-title="لیست  چکهای پرداختی برای تاریخ {{ day.today_pay_cheque.last.cheque_tarik }}"
                                                     data-content="
                                                     <table class='table center-aligned-table mb-0'>
                                                     <thead>
                                                     <tr>
                                                     <th></th>
                                                     <th>بانک</th>
                                                     <th>مبلغ</th>
                                                     </tr>
                                                     </thead>
                                                     <tbody>
                                                             {% for cheque in day.today_pay_cheque %}
{% with 'images/bank/'|add:cheque.bank.bank_logo as logo_path %}
<tr>
<td><img src='{% static logo_path %}' class='small-logo'></td>
<td>{{ cheque.bank.name }}</td>
<td>{{ cheque.cost|floatformat:0|intcomma:False }}</td>
</tr>
{% endwith %}
{% endfor %}
</tbody>
</table>">
                                                    <div class="progress-bar progress-bar-striped bg-danger"
                                                         role="progressbar"
                                                         style="width: {% widthratio day.pay max_cheque 100 %}%"
                                                         aria-valuenow="{{ day.pay }}" aria-valuemin="0"
                                                         aria-valuemax="{{ max_cheque }}"></div>
                                                </div>

                                            </div>
                                        </td>
                                    {% else %}
                                        <td></td>
                                    {% endif %}
                                    {% endfor %}
                                </tr>
                            {% endfor %}


                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>


    </div>




{% endblock %}



{% block jscal %}
    <script>

        $(document).ready(function () {
            var currentYear = {{ year }};
            var currentMonth = {{ month }};
            var url = '/';

            console.log("Initial setup");
            console.log("Current Year: " + currentYear);
            console.log("Current Month: " + currentMonth);
            console.log("Initial URL: " + url);

            function loadCalendar(month, year) {
                console.log("Loading calendar for month: " + month + ", year: " + year);
                console.log("URL being used for AJAX call: " + url);

                $.ajax({
                    url: url,
                    type: 'GET',
                    data: {month: month, year: year},
                    success: function (data) {
                        console.log("AJAX call success");
                        $('#calendarf').html(data);
                    },
                    error: function (xhr, status, error) {
                        console.error('Error loading calendar: ', error);
                        console.error('XHR:', xhr);
                        console.error('Status:', status);
                    }
                });
            }

            $('#prev-month').click(function (e) {
                e.preventDefault();
                if (currentMonth === 1) {
                    currentMonth = 12;
                    currentYear -= 1;
                } else {
                    currentMonth -= 1;
                }
                console.log("Previous month clicked. New Month: " + currentMonth + ", Year: " + currentYear);
                loadCalendar(currentMonth, currentYear);
            });

            $('#next-month').click(function (e) {
                e.preventDefault();
                if (currentMonth === 12) {
                    currentMonth = 1;
                    currentYear += 1;
                } else {
                    currentMonth += 1;
                }
                console.log("Next month clicked. New Month: " + currentMonth + ", Year: " + currentYear);
                loadCalendar(currentMonth, currentYear);
            });
        });


    </script>
    {#برای تقویم#}
    <script>
        $(document).ready(function () {
            $('[data-toggle="popover"]').popover({
                trigger: 'click',  // تنظیم برای فعال‌سازی فقط با کلیک
                placement: 'top',
                html: true
            });

            // بستن Popover زمانی که در جای دیگری کلیک شود
            $(document).on('click', function (e) {
                $('[data-toggle="popover"]').each(function () {
                    // اگر روی عنصر Popover کلیک نشده باشد
                    if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {
                        $(this).popover('hide');
                    }
                });
            });
        });
    </script>

{% endblock %}





{% block myjs %}
    <!-- نمایش تاریخ و ساعت-->
    <script>
        function updateDateTime() {
            const now = new Date();
            const days = ["یکشنبه", "دوشنبه", "سه‌شنبه", "چهارشنبه", "پنج‌شنبه", "جمعه", "شنبه"];
            const dayName = days[now.getDay()];
            const date = now.toLocaleDateString('fa-IR');
            const time = now.toLocaleTimeString('fa-IR');

            document.getElementById("datetime").innerHTML = `${dayName}، ${date}، ${time}`;
        }

        // به روز رسانی هر ثانیه
        setInterval(updateDateTime, 1000);

        // نمایش اولیه
        updateDateTime();
    </script>



    <!--    1   نمودار مقایسه سود ناویژه روزانه -->
    <script>
        // دریافت داده‌های تاریخی از Django
        var labels = [
            {% for report in chart1_data.labels %}
                "{{ report }}"{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var khales_forosh = [
            {% for value in chart1_data.khales_forosh %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var baha_tamam_forosh = [
            {% for value in chart1_data.baha_tamam_forosh %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var sood_navizhe = [
            {% for value in chart1_data.sood_navizhe %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        // ساختار داده برای رسم
        var data = {
            labels: labels,
            datasets: [
                {
                    label: 'خالص فروش',
                    data: khales_forosh,
                    backgroundColor: 'rgba(0, 123, 255, 0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1,
                },
                {
                    label: 'بهای تمام شده',
                    data: baha_tamam_forosh,
                    backgroundColor: 'rgba(255, 99, 132, 0.6)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1,
                },
                {
                    label: 'سود ناویژه',
                    data: sood_navizhe,
                    backgroundColor: 'rgba(75, 192, 192, 0.6)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1,
                }
            ]
        };

        var options = {
            scales: {
                y: {
                    beginAtZero: true
                }
            },
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                }
            }
        };

        // با استفاده از تابع drawChart برای رسم
        drawChart('Chart1', 'bar', data, options);
        // اعمال کلاس‌های CSS به عناصر نمودار

    </script>


    <!--    2      نمودار مقایسه سود ناویژه ماهانه -->
    <script>
        // دریافت داده‌های تاریخی از Django
        var labels = [
            {% for report in chart2_data.labels %}
                "{{ report }}"{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var khales_forosh = [
            {% for value in chart2_data.khales_forosh %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var baha_tamam_forosh = [
            {% for value in chart2_data.baha_tamam_forosh %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var sood_navizhe = [
            {% for value in chart2_data.sood_navizhe %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        // ساختار داده برای رسم
        var data = {
            labels: labels,
            datasets: [
                {
                    label: 'خالص فروش',
                    data: khales_forosh,
                    backgroundColor: 'rgba(0,111,255,0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1,
                },
                {
                    label: 'بهای تمام شده',
                    data: baha_tamam_forosh,
                    backgroundColor: 'rgba(255, 99, 132, 0.6)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1,
                },
                {
                    label: 'سود ناویژه',
                    data: sood_navizhe,
                    backgroundColor: 'rgba(75, 192, 192, 0.6)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1,
                }
            ]
        };

        var options = {
            scales: {
                y: {
                    beginAtZero: true
                }
            },
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                }
            }
        };

        // با استفاده از تابع drawChart برای رسم
        drawChart('Chart2', 'bar', data, options);

        // بررسی داده‌ها در کنسول
        console.log("Labels: ", labels);
        console.log("Khales Forosh Data: ", khales_forosh);
        console.log("Baha Tamam Forosh Data: ", baha_tamam_forosh);
        console.log("Sood Navizhe Data: ", sood_navizhe);
    </script>



    <!--    4   نمودار مقایسه سود ناویژه روزانه -->
    <script>
        // دریافت داده‌های تاریخی از Django
        var labels = [
            {% for report in chart4_data.labels %}
                "{{ report }}"{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var total_daramad = [
            {% for value in chart4_data.total_daramad %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var total_hazineh = [
            {% for value in chart4_data.total_hazineh %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var sood_vizhe = [
            {% for value in chart4_data.sood_vizhe %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        // ساختار داده برای رسم
        var data = {
            labels: labels,
            datasets: [
                {
                    label: 'کل در آمد',
                    data: total_daramad,
                    backgroundColor: 'rgba(54, 162, 235, 0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1,
                },
                {
                    label: 'کل هزینه',
                    data: total_hazineh,
                    backgroundColor: 'rgba(255, 99, 132, 0.6)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1,
                },
                {
                    label: 'سود ویژه',
                    data: sood_vizhe,
                    backgroundColor: 'rgba(75, 192, 192, 0.6)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1,
                }
            ]
        };

        var options = {
            scales: {
                y: {
                    beginAtZero: true
                }
            },
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                }
            }
        };

        // با استفاده از تابع drawChart برای رسم
        drawChart('Chart4', 'bar', data, options);
        // اعمال کلاس‌های CSS به عناصر نمودار

    </script>



    <!--    5   نمودار مقایسه سود ناویژه روزانه -->
    <script>
        // دریافت داده‌های تاریخی از Django
        var labels = [
            {% for report in chart5_data.labels %}
                "{{ report }}"{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var total_daramad = [
            {% for value in chart5_data.total_daramad %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var total_hazineh = [
            {% for value in chart5_data.total_hazineh %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        var sood_vizhe = [
            {% for value in chart5_data.sood_vizhe %}
                {{ value }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        // ساختار داده برای رسم
        var data = {
            labels: labels,
            datasets: [
                {
                    label: 'کل در آمد',
                    data: total_daramad,
                    backgroundColor: 'rgba(54, 162, 235, 0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1,
                },
                {
                    label: 'کل هزینه',
                    data: total_hazineh,
                    backgroundColor: 'rgba(255, 99, 132, 0.6)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1,
                },
                {
                    label: 'سود ویژه',
                    data: sood_vizhe,
                    backgroundColor: 'rgba(75, 192, 192, 0.6)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1,
                }
            ]
        };

        var options = {
            scales: {
                y: {
                    beginAtZero: true
                }
            },
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                }
            }
        };

        // با استفاده از تابع drawChart برای رسم
        drawChart('Chart5', 'bar', data, options);
        // اعمال کلاس‌های CSS به عناصر نمودار

    </script>




    <!-- چارت 7 میله ای برآیند روز های هفته -->
    <script>
        const today = new Date();
        const dates = [];
        for (let i = 0; i <= 7; i++) {
            const day = new Date(today);
            day.setDate(today.getDate() - i);
            dates.push(day.toLocaleDateString('fa-IR', {weekday: 'long'}));
        }

        var dataValues = [
            {% for value in chart7_data %}
                {{ value }},
            {% endfor %}
        ];

        dates.reverse();
        {#dataValues.reverse(); // نیز باید برعکس شوند#}

        console.log(dataValues); // چاپ داده‌ها برای بررسی

        var backgroundColors = Array(dates.length).fill('rgba(75, 192, 192, 1)');
        var borderColors = Array(dates.length).fill('rgba(75, 192, 192, 1)');

        var data = {
            labels: dates,
            datasets: [{
                label: 'عملکرد روزانه',
                data: dataValues,
                backgroundColor: backgroundColors,
                borderColor: borderColors,
                borderWidth: 1
            }]
        };

        var options = {
            scales: {
                y: {
                    beginAtZero: false // به منظور نمایش مقادیر منفی
                }
            }
        };

        drawChart('Chart7', 'bar', data, options);
    </script>



{% endblock %}


{% block date %}


{% endblock %}


