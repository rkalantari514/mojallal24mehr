{% extends 'shared/_MainLayout.html' %}
{% load static %}
{% load humanize %}
{% block content %}
<style>
    .chart-container { width: 100%; height: 500px; margin-bottom: 30px; }
</style>
<div class="content-wrapper">
    <div class="page-title">
        <div class="row">
            <div class="col-sm-6">
                <h4 class="card-title text-facebook pb-0 border-0">
                    جزئیات بودجه فروش مقداری سال {{ acc_year }} - {{ detail_name }}
                </h4>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb pt-0 pr-0 float-left float-sm-right">
                    <li class="breadcrumb-item"><a href="/">خانه</a></li>
                    <li class="breadcrumb-item active">جزئیات بودجه فروش مقداری</li>
                </ol>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 mb-30">
                <div class="card card-statistics h-100">
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="qtyChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block myjs %}
<script src="{% static 'js/chart.js/chart.umd.js' %}"></script>
<script>
    const ctx = document.getElementById('qtyChart').getContext('2d');
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: {{ chart_labels|safe }},
            datasets: [
                { label: "عملکرد سال گذشته (تعداد)", data: {{ chart1_data|safe }}, borderColor: "blue", fill: false },
                { label: "عملکرد سال جاری (تعداد)", data: {{ chart2_data|safe }}, borderColor: "green", fill: false },
                { label: "بودجه با آهنگ پارسال (تعداد)", data: {{ chart3_data|safe }}, borderColor: "red", fill: false },
                { label: "بودجه خطی (تعداد)", data: {{ chart4_data|safe }}, borderColor: "teal", fill: false }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: { title: { display: true, text: "تاریخ" } },
                y: { title: { display: true, text: "تعداد تجمعی" } }
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        label: ctx => `${ctx.dataset.label}: ${ctx.parsed.y.toFixed(0)}`,
                        title: items => `تاریخ: ${items[0].label}`
                    }
                }
            }
        }
    });
</script>
{% endblock %}